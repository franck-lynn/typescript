import { ref, computed } from 'vue'

interface TreeNode {
  id: number;
  name: string;
  children?: TreeNode[];
}

interface StackNode {
  node: TreeNode;
  level: number;
}

export default function useTreeData(treeData: TreeNode[]) {
  const stack = ref<StackNode[]>([{ node: { id: -1, name: '', children: treeData }, level: -1 }]);
  const indentSize = 20;

  const renderedTreeData = computed(() => {
    const result: string[] = [];

    while (stack.value.length > 0) {
      const { node, level } = stack.value.pop()!;

      if (node.id !== -1) {
        result.push(`<div style="padding-left: ${level * indentSize}px">${node.name}</div>`);
      }

      if (node.children && node.children.length > 0) {
        for (let i = node.children.length - 1; i >= 0; i--) {
          stack.value.push({ node: node.children[i], level: level + 1 });
        }
      }
    }

    return result.join('');
  });

  return {
    renderedTreeData,
  };
}